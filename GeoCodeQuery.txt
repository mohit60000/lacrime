SELECT * FROM ( SELECT * FROM (SELECT z.latitude, z.longitude, p.radius, p.distance_unit * rad2deg * (ACOS(COS(deg2rad * (p.latpoint)) * COS(deg2rad * (z.latitude))* COS(deg2rad * (p.longpoint - z.longitude)) + SIN(deg2rad * (p.latpoint)) * SIN(deg2rad * (z.latitude)))) AS distance FROM geotest z JOIN (SELECT  34.0522 AS latpoint, -118.2437 AS longpoint, 50.0 AS radius, 111.045 AS distance_unit, 57.2957795 AS rad2deg, 0.0174532925 AS deg2rad FROM  DUAL) p ON 1=1 WHERE z.latitude BETWEEN p.latpoint  - (p.radius / p.distance_unit) AND p.latpoint  + (p.radius /p.distance_unit) AND z.longitude BETWEEN p.longpoint - (p.radius / (p.distance_unit * COS(deg2rad * (p.latpoint)))) AND p.longpoint + (p.radius / (p.distance_unit * COS(deg2rad * (p.latpoint))))) WHERE distance <= radius ORDER BY distance) WHERE ROWNUM <= 20;